(function (d3) {
  'use strict';

  const svg = d3.select('svg');

  const width = +svg.attr('width');
  const height = +svg.attr('height');

  const render = data => {
    
    const nested = d3.nest()
      .key(function(d) {return d["Country/Region"];})
      .rollup(function(d) {
          return {
              latestConfirmedCases: d3.sum(d, function(e) { return e["7/22/20"]; }),
              //country: d3.sum(d, function(e) { return e.line2; })
          };
      })
      .entries(data);

  	//console.log(nested);
    
  	//data = data.sort((a, b) => descending(+a["7/22/20"], +b["7/22/20"])).slice(0,30)
    
    data = nested.sort((a, b) => d3.descending(+a["value"]["latestConfirmedCases"], +b["value"]["latestConfirmedCases"])).slice(0,10);
    
    console.log(data);
    
  	const xValue = d => d["value"]["latestConfirmedCases"];
    const yValue = d => d["key"];


    const mergin = {
    	top:60, bottom:85, left:200, right:20
    };
    const innerWidth = width -  mergin.left - mergin.right;
    const innerHeight = height -  mergin.top - mergin.bottom;
    
  	const xScale = d3.scaleLinear()
    	.domain([0,d3.max(data, xValue)])
    	.range([0,innerWidth]);
    
    
    
    const yScale = d3.scaleBand()
    	.domain(data.map(yValue))
    	.range([0,innerHeight])
    	.padding(0.11);
    
    
    const g = svg.append('g')
    	.attr('transform',`translate(${mergin.left},${mergin.top})`);
    
    const xAxisTickFormat = number => d3.format('.3s')(number).replace('G','B');
    
    const xAxis = d3.axisBottom(xScale).tickFormat(xAxisTickFormat).tickSize(-innerHeight);
    
    g.append('g').call(d3.axisLeft(yScale))
    	.selectAll('.domain,.tick line')
    		.remove();
    const xAxisG = g.append('g').call(xAxis)
    	.attr('transform',`translate(0,${innerHeight})`);
    
  	xAxisG.selectAll('.domain').remove(); 
    
    xAxisG.append('text')
    	.attr('class', 'axis-label')
      .attr('y',70)
    	.attr('x',innerWidth/2)
    	.attr('fill','black')
      .text('Number of Confirmed Cases as on 7/22/2020');
    
    g.selectAll('rect').data(data)
    	.enter().append('rect')
    		.attr('y',d => yScale(yValue(d)))
    		.attr('width',d => xScale(xValue(d)))
    		.attr('height',yScale.bandwidth());
    
    g.append('text')
      .attr('class', 'title')
      .attr('y',-10)
      .text('Top 10 Countries');
    
  };

  d3.csv('https://github.com/rasbiharipal/testpub/blob/master/data.csv').then(data => {
  	data.forEach(d => {
    	d.population=+d.population*1000;
    });
    render(data);
  });

}(d3));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFxuICBzZWxlY3QsIFxuICBjc3YsIFxuICBzY2FsZUxpbmVhciwgXG4gIG1heCwgXG4gIHNjYWxlQmFuZCwgXG4gIGF4aXNMZWZ0LCBcbiAgYXhpc0JvdHRvbSwgXG4gIGZvcm1hdCwgXG4gIGRlc2NlbmRpbmcsIFxuICBuZXN0LFxuXHRzdW1cbn0gZnJvbSAnZDMnO1xuXG5jb25zdCBzdmcgPSBzZWxlY3QoJ3N2ZycpO1xuXG5jb25zdCB3aWR0aCA9ICtzdmcuYXR0cignd2lkdGgnKTtcbmNvbnN0IGhlaWdodCA9ICtzdmcuYXR0cignaGVpZ2h0Jyk7XG5cbmNvbnN0IHJlbmRlciA9IGRhdGEgPT4ge1xuICBcbiAgY29uc3QgbmVzdGVkID0gbmVzdCgpXG4gICAgLmtleShmdW5jdGlvbihkKSB7cmV0dXJuIGRbXCJDb3VudHJ5L1JlZ2lvblwiXTt9KVxuICAgIC5yb2xsdXAoZnVuY3Rpb24oZCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGF0ZXN0Q29uZmlybWVkQ2FzZXM6IHN1bShkLCBmdW5jdGlvbihlKSB7IHJldHVybiBlW1wiNy8yMi8yMFwiXTsgfSksXG4gICAgICAgICAgICAvL2NvdW50cnk6IGQzLnN1bShkLCBmdW5jdGlvbihlKSB7IHJldHVybiBlLmxpbmUyOyB9KVxuICAgICAgICB9O1xuICAgIH0pXG4gICAgLmVudHJpZXMoZGF0YSk7XG5cblx0Ly9jb25zb2xlLmxvZyhuZXN0ZWQpO1xuICBcblx0Ly9kYXRhID0gZGF0YS5zb3J0KChhLCBiKSA9PiBkZXNjZW5kaW5nKCthW1wiNy8yMi8yMFwiXSwgK2JbXCI3LzIyLzIwXCJdKSkuc2xpY2UoMCwzMClcbiAgXG4gIGRhdGEgPSBuZXN0ZWQuc29ydCgoYSwgYikgPT4gZGVzY2VuZGluZygrYVtcInZhbHVlXCJdW1wibGF0ZXN0Q29uZmlybWVkQ2FzZXNcIl0sICtiW1widmFsdWVcIl1bXCJsYXRlc3RDb25maXJtZWRDYXNlc1wiXSkpLnNsaWNlKDAsMTApXG4gIFxuICBjb25zb2xlLmxvZyhkYXRhKVxuICBcblx0Y29uc3QgeFZhbHVlID0gZCA9PiBkW1widmFsdWVcIl1bXCJsYXRlc3RDb25maXJtZWRDYXNlc1wiXTtcbiAgY29uc3QgeVZhbHVlID0gZCA9PiBkW1wia2V5XCJdO1xuXG5cbiAgY29uc3QgbWVyZ2luID0ge1xuICBcdHRvcDo2MCwgYm90dG9tOjg1LCBsZWZ0OjIwMCwgcmlnaHQ6MjBcbiAgfTtcbiAgY29uc3QgaW5uZXJXaWR0aCA9IHdpZHRoIC0gIG1lcmdpbi5sZWZ0IC0gbWVyZ2luLnJpZ2h0O1xuICBjb25zdCBpbm5lckhlaWdodCA9IGhlaWdodCAtICBtZXJnaW4udG9wIC0gbWVyZ2luLmJvdHRvbTtcbiAgXG5cdGNvbnN0IHhTY2FsZSA9IHNjYWxlTGluZWFyKClcbiAgXHQuZG9tYWluKFswLG1heChkYXRhLCB4VmFsdWUpXSlcbiAgXHQucmFuZ2UoWzAsaW5uZXJXaWR0aF0pO1xuICBcbiAgXG4gIFxuICBjb25zdCB5U2NhbGUgPSBzY2FsZUJhbmQoKVxuICBcdC5kb21haW4oZGF0YS5tYXAoeVZhbHVlKSlcbiAgXHQucmFuZ2UoWzAsaW5uZXJIZWlnaHRdKVxuICBcdC5wYWRkaW5nKDAuMTEpO1xuICBcbiAgXG4gIGNvbnN0IGcgPSBzdmcuYXBwZW5kKCdnJylcbiAgXHQuYXR0cigndHJhbnNmb3JtJyxgdHJhbnNsYXRlKCR7bWVyZ2luLmxlZnR9LCR7bWVyZ2luLnRvcH0pYCk7XG4gIFxuICBjb25zdCB4QXhpc1RpY2tGb3JtYXQgPSBudW1iZXIgPT4gZm9ybWF0KCcuM3MnKShudW1iZXIpLnJlcGxhY2UoJ0cnLCdCJyk7XG4gIFxuICBjb25zdCB4QXhpcyA9IGF4aXNCb3R0b20oeFNjYWxlKS50aWNrRm9ybWF0KHhBeGlzVGlja0Zvcm1hdCkudGlja1NpemUoLWlubmVySGVpZ2h0KTtcbiAgXG4gIGcuYXBwZW5kKCdnJykuY2FsbChheGlzTGVmdCh5U2NhbGUpKVxuICBcdC5zZWxlY3RBbGwoJy5kb21haW4sLnRpY2sgbGluZScpXG4gIFx0XHQucmVtb3ZlKCk7XG4gIGNvbnN0IHhBeGlzRyA9IGcuYXBwZW5kKCdnJykuY2FsbCh4QXhpcylcbiAgXHQuYXR0cigndHJhbnNmb3JtJyxgdHJhbnNsYXRlKDAsJHtpbm5lckhlaWdodH0pYCk7XG4gIFxuXHR4QXhpc0cuc2VsZWN0QWxsKCcuZG9tYWluJykucmVtb3ZlKCk7IFxuICBcbiAgeEF4aXNHLmFwcGVuZCgndGV4dCcpXG4gIFx0LmF0dHIoJ2NsYXNzJywgJ2F4aXMtbGFiZWwnKVxuICAgIC5hdHRyKCd5Jyw3MClcbiAgXHQuYXR0cigneCcsaW5uZXJXaWR0aC8yKVxuICBcdC5hdHRyKCdmaWxsJywnYmxhY2snKVxuICAgIC50ZXh0KCdOdW1iZXIgb2YgQ29uZmlybWVkIENhc2VzIGFzIG9uIDcvMjIvMjAyMCcpO1xuICBcbiAgZy5zZWxlY3RBbGwoJ3JlY3QnKS5kYXRhKGRhdGEpXG4gIFx0LmVudGVyKCkuYXBwZW5kKCdyZWN0JylcbiAgXHRcdC5hdHRyKCd5JyxkID0+IHlTY2FsZSh5VmFsdWUoZCkpKVxuICBcdFx0LmF0dHIoJ3dpZHRoJyxkID0+IHhTY2FsZSh4VmFsdWUoZCkpKVxuICBcdFx0LmF0dHIoJ2hlaWdodCcseVNjYWxlLmJhbmR3aWR0aCgpKVxuICBcbiAgZy5hcHBlbmQoJ3RleHQnKVxuICAgIC5hdHRyKCdjbGFzcycsICd0aXRsZScpXG4gICAgLmF0dHIoJ3knLC0xMClcbiAgICAudGV4dCgnVG9wIDEwIENvdW50cmllcycpO1xuICBcbn07XG5cbmNzdignZGF0YS5jc3YnKS50aGVuKGRhdGEgPT4ge1xuXHRkYXRhLmZvckVhY2goZCA9PiB7XG4gIFx0ZC5wb3B1bGF0aW9uPStkLnBvcHVsYXRpb24qMTAwMDtcbiAgfSk7XG4gIHJlbmRlcihkYXRhKTtcbn0pOyJdLCJuYW1lcyI6WyJzZWxlY3QiLCJuZXN0Iiwic3VtIiwiZGVzY2VuZGluZyIsInNjYWxlTGluZWFy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